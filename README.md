# packet-analyzer
A Program Used to Split, Measure, Classify the packet trace(.pcap file)

## preparations
- Install dpkt library: [dpkt documentation](http://dpkt.readthedocs.org/en/latest/index.html)
- .pcap format: [libpcap file format](https://wiki.wireshark.org/Development/LibpcapFileFormat)

## Usage:
1. Use `CertTraSplit.py` to split the packet trace.
  1. Reads 24 bytes .pcap global head
  2. Then read each packet header field packet head (including 8 bytes ts, 4 bytes snaplen, 4 bytes packetlen)
  3. To read the message content based on the length of snaplen
  4. Use dpkt library to parse out the source and dst ip address for traffic segmentation
  5. If the src and dst ip appears the first time, global head will be written to the file, and writes the relevant header packet payload content, if not the first time, only the header and the relevant  load content be written.
2. Then use CertTraSpec.py to measure the packet trace.
  1. use file `pcaplist`(generated by `CerTraSplit.py`) which records the file name after the split, to identify the source and sink IP) were measure
  2. measure includes source and dst ports, protocol number, packet count, port count of the source and sink.
3. Last use `CertTraClassify.py` to classify the packet trace.
